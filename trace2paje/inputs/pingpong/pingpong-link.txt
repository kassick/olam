CONTAINER Machine {
  NAME "%(my_hostname)"
  CREATE init
  DESTROY finalize

  CONTAINER Rank {
    NAME "rank_%(rank)"
    CREATE PARENT
    DESTROY PARENT
  
    STATETYPE PingState {
      ping_s
    }


  }

  LINKTYPE PingLink FROM Rank TO Rank {
    ping
  }

}

LINK ping {
  VALUE "msg_%(tag)"
  KEY "%(tag)##%(dst)"
  i tag
  i dst
}

STATE ping_s {
  i tag
  i dst
}

EVENT init {
  VALUE "%(EVT_NAME)"
  s hostname

  PUSH hostname AS my_hostname
}

EVENT finalize {
  VALUE "%(EVT_NAME)"
}

ID ping_s 4001 101
ID ping   4001 4002
